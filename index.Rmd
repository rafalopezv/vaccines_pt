---
title: 'COVID-19:<span style="color: #ED0973;">PROGRESSO</span> GLOBAL DE VACINAÇÃO'
output: 
  html_document: 
    css: style.css
---

```{r setup, warnings = FALSE, message = FALSE, include = FALSE}
knitr::opts_chunk$set(warnings = FALSE, message = FALSE, echo = FALSE)


library(tidyverse)
library(reactable)
library(sparkline)
library(htmltools)
library(htmlwidgets)
library(magrittr)

source("code/limpieza_1.R")
options(scipen = 999)
```

<br>

O processo de vacinação não acontece da mesma maneira nas diferentes regiões do mundo. Por que alguns países avançam em grande velocidade no processo enquanto outros países estão apenas começando?  <span style="color: #ED0973;">**Na Avina, estamos trabalhando para que a vacina seja um bem público universal**</span> e esperamos que este seja um espaço de conscientização sobre o tema. As grandes desigualdades nunca são justas, muito menos quando há vidas em jogo. 

A tabela é interativa. Ao clicar sobre o título das colunas, os registros aparecerão em ordem alfabética se forem palavras ou em ordem crescente (e vice-versa) se foram números.   

Fonte dos dados: [Our World in Data](https://github.com/owid/covid-19-data/blob/master/public/data/README.md) e [Johns Hopkins](https://github.com/CSSEGISandData/COVID-19)

<small>Elaborado por [Rafael López V.](https://rafalopezv.io/) e [Juan Cristóbal Birbuet](https://www.linkedin.com/in/juan-cristóbal-birbuet-rosazza-b563208/)</small>
<br>
```{r echo = FALSE}
### función para la barra de progreso


bar_chart <-
  function(label,
           width = "100%",
           height = "16px",
           fill = "#00bfc4",
           background = NULL) {
    bar <-
      div(style = list(
        background = fill,
        width = width,
        height = height
      ))
    chart <-
      div(style = list(
        flexGrow = 1,
        marginLeft = "8px",
        background = background
      ),
      bar)
    div(style = list(display = "flex", alignItems = "center"), label, chart)
  }

# funcion de colores 
make_color_pal <- function(colors, bias = 1) {
  get_color <- colorRamp(colors, bias = bias)
  function(x)
    rgb(get_color(x), maxColorValue = 255)
}

reactable(
    temp,
    pagination = FALSE,
    showSortIcon = FALSE,
    highlight = TRUE,
    compact = TRUE,
    searchable = TRUE,
    language = reactableLang(
      searchPlaceholder = "País de pesquisa"
    ),
    defaultSorted = "people_vaccinated_per_hundred",
    defaultSortOrder = "desc",
    defaultColDef = colDef(headerClass = "header colheader"),
    columnGroups = list(
      colGroup(
        name = "Curva de casos desde o princípio da pandemia [por semana]",
        columns = c("confirmados", "fallecidos"),
        headerClass = "groupheader"
      ),
      colGroup(
        name = "Contexto",
        columns = c("nombre_espanol", "date"),
        headerClass = "groupheader"
      ),
      colGroup(
        name = "Desempenho da vacinação",
        columns = c("people_vaccinated_per_hundred", "people_fully_vaccinated_per_hundred", "total_boosters_per_hundred"),
        headerClass = "groupheader"
      )
    ),
    columns = list(
      confirmados = colDef(class = "sparkys",
                           name = "Infectados",
                           align = "center",
                           cell = function(values) {
    sparkline(values, type = "line", chartRangeMin = 0, height = "80%", width = "70%",
              fillColor = "#E1E1E1", lineColor = "#073B4C", lineWidth = 3)
  }),
  fallecidos = colDef(class = "sparkys",
                      name = "Óbitos",
                      align = "center",
                      cell = function(values) {
    sparkline(values, type = "line", chartRangeMin = 0, height = "75%", width = "60%",
              fillColor = "#E1E1E1", lineColor = "#073B4C", lineWidth = 3)
  }),
      
    people_vaccinated_per_hundred = colDef(
        class = "cell number border-left",
        name = "Pessoas vacinadas com ao menos uma dose [%]",
        align = "center",
        headerStyle = list(fontWeight = "400"),
        cell = function(value) {
          width <- paste0(value, "%")
          bar_chart(value,
                    width = width,
                    fill = "#ED0973",
                    background = "#E1E1E1")
        }
      ),
  
    people_fully_vaccinated_per_hundred = colDef(
        class = "cell number border-left",
        name = "Pessoas vacinadas com doses completas [%]",
        align = "center",
        headerStyle = list(fontWeight = "400"),
        cell = function(value) {
          width <- paste0(value, "%")
          bar_chart(value,
                    width = width,
                    fill = "#00bfc4",
                    background = "#E1E1E1")
        }
      ),
      
      total_boosters_per_hundred = colDef(
        class = "cell number border-left",
        name = "Pessoas vacinadas com doses extras às inicialmente programadas [%]",
        align = "center",
        headerStyle = list(fontWeight = "400"),
        cell = function(value) {
          width <- paste0(value, "%")
          bar_chart(value,
                    width = width,
                    fill = "#073B4C",
                    background = "#E1E1E1")
        }
      ),
      
      date = colDef(name = "Atualização das informações", align = "center", 
                    width = 120, 
                    class = "division-name cell",
                    ),
  nombre_espanol = colDef(name = "País",
                          headerStyle = list(align = "center"),
                          class = "division-name cell")
    )
  )
    
```

<hr>

Descrição das variáveis

- **Pessoas vacinadas com ao menos uma dose [%]**: Número total de pessoas que receberam pelo menos uma dose de alguma vacina, para cada 100 pessoas da população total do país.

- **Pessoas vacinadas com doses completas [%]**: Número total de pessoas que receberam todas as doses prescritas no protocolo de vacinação, para cada 100 pessoas na população total do país. Embora a maioria das vacinas exija a aplicação de duas doses, em alguns casos, apenas uma dose é necessária.

- **Pessoas vacinadas com doses extras às inicialmente programadas [%]**: Número total de doses de reforço da vacina COVID-19, administradas a cada 100 pessoas da população total do país. Observou-se que após alguns meses de recebimento das doses completas estabelecidas no protocolo de vacinação, há diminuição na quantidade de anticorpos. Por essa razão, alguns países autorizaram o fornecimento de uma dose adicional de reforço.
<hr>

Menções 

A elaboração da tabela foi inspirada nas seguintes fontes: 

- [New York Times](https://www.nytimes.com/interactive/2021/01/25/world/europe/global-vaccination-population-rate.html)
- [Kyle Cuilla](https://rafalopezv.github.io/vaccines/)
- [Reactable](https://glin.github.io/reactable/)

<hr>
[Código](https://github.com/rafalopezv/vaccines_pt)

<br>








